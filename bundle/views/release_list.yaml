name: release_list
definition:
  # Wires connect to data in collections
  wires:
    release:
      collection: uesio/docs.release
      batchsize: 10
      fields:
        uesio/docs.number:
        uesio/docs.notes:
    downloadOpts:
      viewOnly: true
      fields:
        platform:
          label: "Select your operating system"
          type: SELECT
          selectlist:
            name: uesio/docs.release_platform
        arch:
          label: "Select your system architecture"
          type: SELECT
          selectlist:
            name: uesio/docs.system_architecture
      init:
        create: true
      defaults:
        - field: platform
          valueSource: VALUE
          value: mac
        - field: arch
          valueSource: VALUE
          value: amd64
  # Components determine the layout and composition of your view
  components:
    - uesio/io.viewlayout:
        header:
          - uesio/core.view:
              view: uesio/docs.topbar
        content:
          - uesio/io.titlebar:
              title: $Collection{release:pluralLabel}
              subtitle: List View
              uesio.variant: uesio/io.main
              actions:
                - uesio/io.group:
                    components:
                      - uesio/io.button:
                          signals:
                            - signal: panel/TOGGLE
                              panel: downloadReleasePanel
                          text: Download latest release
                          uesio.variant: uesio/io.secondary
                      - uesio/io.button:
                          signals:
                            - signal: wire/CREATE_RECORD
                              wire: release
                              prepend: true
                            - signal: component/CALL
                              component: uesio/io.table
                              componentsignal: SET_EDIT_MODE
                              targettype: specific
                              componentid: releaseTable
                          text: $Label{uesio/io.create}
                          uesio.variant: uesio/io.primary
                      - uesio/io.button:
                          signals:
                            - signal: wire/SAVE
                              wires:
                                - release
                          text: $Label{uesio/io.save}
                          hotkey: "meta+s"
                          uesio.variant: uesio/io.secondary
                          uesio.display:
                            - type: wireHasChanges
                              wire: release
                      - uesio/io.button:
                          signals:
                            - signal: wire/CANCEL
                              wire: release
                          uesio.display:
                            - type: wireHasChanges
                              wire: release
                          text: $Label{uesio/io.cancel}
                          uesio.variant: uesio/io.secondary
                      - uesio/io.button:
                          signals:
                            - signal: component/CALL
                              component: uesio/io.table
                              componentsignal: TOGGLE_MODE
                              targettype: specific
                              componentid: releaseTable
                          text: Mode
                          uesio.variant: uesio/io.secondary
          - uesio/io.box:
              uesio.variant: uesio/io.section
              components:
                - uesio/io.table:
                    rowactions:
                      - icon: visibility
                        text: View
                        uesio.display:
                          - type: recordIsNotNew
                        signals:
                          - signal: route/NAVIGATE_TO_ASSIGNMENT
                            viewtype: detail
                            recordid: ${uesio/core.id}
                            collection: uesio/docs.release
                      - icon: delete
                        text: $Label{uesio/io.delete}
                        signals:
                          - signal: wire/TOGGLE_DELETE_STATUS
                    columns:
                      - field: uesio/docs.number
                      - field: uesio/docs.notes
                    uesio.id: releaseTable
                    mode: READ
                    wire: release
                    pagesize: 10
  panels:
    downloadReleasePanel:
      uesio.type: uesio/io.dialog
      title: Download release
      width: 400px
      height: 500px
      components:
        - uesio/io.item:
            uesio.id: downloadOpts
            wire: downloadOpts
            mode: EDIT
            components:
              - uesio/io.field:
                  fieldId: platform
              - uesio/io.field:
                  fieldId: arch
                  uesio.display:
                    - field: platform
                      value: "mac"
      actions:
        - uesio/io.button:
            uesio.variant: "uesio/io.primary"
            text: Go
            icon: "arrow_forward"
            signals:
              - signal: "route/NAVIGATE_TO_ROUTE"
                newtab: true
                route: uesio/docs.download_release
                params:
                  platform: "$Record{downloadOpts:platform}"
                  arch: "$Record{downloadOpts:arch}"
        - uesio/io.button:
            uesio.variant: "uesio/io.secondary"
            text: $Label{uesio/io.cancel}
            signals:
              - signal: "panel/TOGGLE"
                panel: "downloadReleasePanel"